ifelse(myDelayT$Month=="April","20150401",
ifelse(myDelayT$Month=="May","20150501",
ifelse(myDelayT$Month=="June","20150601",
ifelse(myDelayT$Month=="July","20150701",
ifelse(myDelayT$Month=="August","20150801",
ifelse(myDelayT$Month=="September","20150901",
ifelse(myDelayT$Month=="October","20151001",
ifelse(myDelayT$Month=="November","20151101","")))))))))))
myDelayT<-myDelayT[c(2:5)]
myDelayT<- myDelayT[order(myDelayT$date),]
View(myDelayT)
View(myDelayT)
str(myDelayT)
write.csv(myDelayT,"myDelayTN.csv",row.names=FALSE)
myDelayT<-myDelay
myDelayT$date<-ifelse(myDelayT$Month=="January",20150101,
ifelse(myDelayT$Month=="February",20150201,
ifelse(myDelayT$Month=="March",20150301,
ifelse(myDelayT$Month=="April",20150401,
ifelse(myDelayT$Month=="May",20150501,
ifelse(myDelayT$Month=="June",20150601,
ifelse(myDelayT$Month=="July",20150701,
ifelse(myDelayT$Month=="August",20150801,
ifelse(myDelayT$Month=="September",20150901,
ifelse(myDelayT$Month=="October",20151001,
ifelse(myDelayT$Month=="November",20151101,"")))))))))))
myDelayT<-myDelayT[c(2:5)]
myDelayT<- myDelayT[order(myDelayT$date),]
write.csv(myDelayT,"myDelayTN.csv",row.names=FALSE)
View(myDelayT)
myDelayT<-myDelay
myDelayT$date<-ifelse(myDelayT$Month=="January",20150101,
ifelse(myDelayT$Month=="February",20150201,
ifelse(myDelayT$Month=="March",20150301,
ifelse(myDelayT$Month=="April",20150401,
ifelse(myDelayT$Month=="May",20150501,
ifelse(myDelayT$Month=="June",20150601,
ifelse(myDelayT$Month=="July",20150701,
ifelse(myDelayT$Month=="August",20150801,
ifelse(myDelayT$Month=="September",20150901,
ifelse(myDelayT$Month=="October",20151001,
ifelse(myDelayT$Month=="November",20151101,0)))))))))))
myDelayT<-myDelayT[c(2:5)]
myDelayT<- myDelayT[order(myDelayT$date),]
write.csv(myDelayT,"myDelayTN.csv",row.names=FALSE)
View(myDelayT)
write.csv(myDelayT,"myDelayTN.csv",row.names=FALSE)
myDelayT<-myDelay
myDelayT$date<-ifelse(myDelayT$Month=="January",20150130,
ifelse(myDelayT$Month=="February",20150230,
ifelse(myDelayT$Month=="March",20150330,
ifelse(myDelayT$Month=="April",20150430,
ifelse(myDelayT$Month=="May",20150530,
ifelse(myDelayT$Month=="June",20150630,
ifelse(myDelayT$Month=="July",20150730,
ifelse(myDelayT$Month=="August",20150830,
ifelse(myDelayT$Month=="September",20150930,
ifelse(myDelayT$Month=="October",20151030,
ifelse(myDelayT$Month=="November",20151130,0)))))))))))
myDelayT<-myDelayT[c(2:5)]
myDelayT<- myDelayT[order(myDelayT$date),]
write.csv(myDelayT,"myDelayTN.csv",row.names=FALSE)
myDelayT<-myDelay
myDelayT$date<-ifelse(myDelayT$Month=="January",as.Date(c("2015-01-30")),
ifelse(myDelayT$Month=="February",as.Date(c("20150230")),
ifelse(myDelayT$Month=="March",as.Date(c("20150330")),
ifelse(myDelayT$Month=="April",as.Date(c("20150430")),
ifelse(myDelayT$Month=="May",as.Date(c("20150530")),
ifelse(myDelayT$Month=="June",as.Date(c("20150630")),
ifelse(myDelayT$Month=="July",as.Date(c("20150730")),
ifelse(myDelayT$Month=="August",as.Date(c("20150830")),
ifelse(myDelayT$Month=="September",as.Date(c("20150930")),
ifelse(myDelayT$Month=="October",as.Date(c("20151030")),
ifelse(myDelayT$Month=="November",as.Date(c("20151130")),0)))))))))))
myDelayT<-myDelay
myDelayT$date<-ifelse(myDelayT$Month=="January",as.Date(c("2015-01-30")),
ifelse(myDelayT$Month=="February",as.Date(c("2015-02-30")),
ifelse(myDelayT$Month=="March",as.Date(c("2015-03-30")),
ifelse(myDelayT$Month=="April",as.Date(c("2015-04-30")),
ifelse(myDelayT$Month=="May",as.Date(c("2015-05-30")),
ifelse(myDelayT$Month=="June",as.Date(c("2015-06-30")),
ifelse(myDelayT$Month=="July",as.Date(c("2015-07-30")),
ifelse(myDelayT$Month=="August",as.Date(c("2015-08-30")),
ifelse(myDelayT$Month=="September",as.Date(c("2015-09-30")),
ifelse(myDelayT$Month=="October",as.Date(c("2015-10-30")),
ifelse(myDelayT$Month=="November",as.Date(c("2015-11-30")),0)))))))))))
myDelayT$date<-ifelse(myDelayT$Month=="January",as.Date(c("2015-01-30")),
ifelse(myDelayT$Month=="February",as.Date(c("2015-02-30")),
ifelse(myDelayT$Month=="March",as.Date(c("2015-03-30")),
ifelse(myDelayT$Month=="April",as.Date(c("2015-04-30")),
ifelse(myDelayT$Month=="May",as.Date(c("2015-05-30")),
ifelse(myDelayT$Month=="June",as.Date(c("2015-06-30")),
ifelse(myDelayT$Month=="July",as.Date(c("2015-07-30")),
ifelse(myDelayT$Month=="August",as.Date(c("2015-08-30")),
ifelse(myDelayT$Month=="September",as.Date(c("2015-09-30")),
ifelse(myDelayT$Month=="October",as.Date(c("2015-10-30")),
ifelse(myDelayT$Month=="November",as.Date(c("2015-11-30")),"")))))))))))
myDelayT$date<-ifelse(myDelayT$Month=="January",as.Date(c("2015-01-30")),
ifelse(myDelayT$Month=="February",as.Date(c("2015-02-28")),
ifelse(myDelayT$Month=="March",as.Date(c("2015-03-30")),
ifelse(myDelayT$Month=="April",as.Date(c("2015-04-30")),
ifelse(myDelayT$Month=="May",as.Date(c("2015-05-30")),
ifelse(myDelayT$Month=="June",as.Date(c("2015-06-30")),
ifelse(myDelayT$Month=="July",as.Date(c("2015-07-30")),
ifelse(myDelayT$Month=="August",as.Date(c("2015-08-30")),
ifelse(myDelayT$Month=="September",as.Date(c("2015-09-30")),
ifelse(myDelayT$Month=="October",as.Date(c("2015-10-30")),
ifelse(myDelayT$Month=="November",as.Date(c("2015-11-30")),"")))))))))))
myDelayT<-myDelayT[c(2:5)]
myDelayT<- myDelayT[order(myDelayT$date),]
View(myDelayT)
myDelayT$date<-ifelse(myDelayT$Month=="January",as.Date(c("2015-01-30",format="%Y-%m-%d")),
ifelse(myDelayT$Month=="February",as.Date(c("2015-02-28",format="%Y-%m-%d")),
ifelse(myDelayT$Month=="March",as.Date(c("2015-03-30",format="%Y-%m-%d")),
ifelse(myDelayT$Month=="April",as.Date(c("2015-04-30",format="%Y-%m-%d")),
ifelse(myDelayT$Month=="May",as.Date(c("2015-05-30",format="%Y-%m-%d")),
ifelse(myDelayT$Month=="June",as.Date(c("2015-06-30",format="%Y-%m-%d")),
ifelse(myDelayT$Month=="July",as.Date(c("2015-07-30",format="%Y-%m-%d")),
ifelse(myDelayT$Month=="August",as.Date(c("2015-08-30",format="%Y-%m-%d")),
ifelse(myDelayT$Month=="September",as.Date(c("2015-09-30",format="%Y-%m-%d")),
ifelse(myDelayT$Month=="October",as.Date(c("2015-10-30",format="%Y-%m-%d")),
ifelse(myDelayT$Month=="November",as.Date(c("2015-11-30",format="%Y-%m-%d")),"")))))))))))
myDelayT<-myDelay
myDelayT$date<-ifelse(myDelayT$Month=="January",as.Date(c("2015-01-30",format="%Y-%m-%d")),
ifelse(myDelayT$Month=="February",as.Date(c("2015-02-28",format="%Y-%m-%d")),
ifelse(myDelayT$Month=="March",as.Date(c("2015-03-30",format="%Y-%m-%d")),
ifelse(myDelayT$Month=="April",as.Date(c("2015-04-30",format="%Y-%m-%d")),
ifelse(myDelayT$Month=="May",as.Date(c("2015-05-30",format="%Y-%m-%d")),
ifelse(myDelayT$Month=="June",as.Date(c("2015-06-30",format="%Y-%m-%d")),
ifelse(myDelayT$Month=="July",as.Date(c("2015-07-30",format="%Y-%m-%d")),
ifelse(myDelayT$Month=="August",as.Date(c("2015-08-30",format="%Y-%m-%d")),
ifelse(myDelayT$Month=="September",as.Date(c("2015-09-30",format="%Y-%m-%d")),
ifelse(myDelayT$Month=="October",as.Date(c("2015-10-30",format="%Y-%m-%d")),
ifelse(myDelayT$Month=="November",as.Date(c("2015-11-30",format="%Y-%m-%d")),"")))))))))))
myDelayT<-myDelayT[c(2:5)]
myDelayT<- myDelayT[order(myDelayT$date),]
View(myDelayT)
myDelayT<-myDelay
myDelayT$date<-ifelse(myDelayT$Month=="January",20150130,
ifelse(myDelayT$Month=="February",20150228,
ifelse(myDelayT$Month=="March",20150330,
ifelse(myDelayT$Month=="April",20150430,
ifelse(myDelayT$Month=="May",20150530,
ifelse(myDelayT$Month=="June",20150630,
ifelse(myDelayT$Month=="July",20150730,
ifelse(myDelayT$Month=="August",20150830,
ifelse(myDelayT$Month=="September",20150930,
ifelse(myDelayT$Month=="October",20151030,
ifelse(myDelayT$Month=="November",20151130,0)))))))))))
myDelayT<-myDelayT[c(2:5)]
myDelayT<- myDelayT[order(myDelayT$date),]
write.csv(myDelayT,"myDelayTN.csv",row.names=FALSE)
myDelayT<-myDelay
myDelayT$date<-ifelse(myDelayT$Month=="January","2015-01-30",
ifelse(myDelayT$Month=="February","2015-02-28",
ifelse(myDelayT$Month=="March","2015-03-30",
ifelse(myDelayT$Month=="April","2015-04-30",
ifelse(myDelayT$Month=="May","2015-05-30",
ifelse(myDelayT$Month=="June","2015-06-30",
ifelse(myDelayT$Month=="July","2015-07-30",
ifelse(myDelayT$Month=="August","2015-08-30",
ifelse(myDelayT$Month=="September","2015-09-30",
ifelse(myDelayT$Month=="October","2015-10-30",
"2015-11-30")))))))))))
myDelayT<-myDelay
myDelayT$date<-ifelse(myDelayT$Month=="January","2015-01-30",
ifelse(myDelayT$Month=="February","2015-02-28",
ifelse(myDelayT$Month=="March","2015-03-30",
ifelse(myDelayT$Month=="April","2015-04-30",
ifelse(myDelayT$Month=="May","2015-05-30",
ifelse(myDelayT$Month=="June","2015-06-30",
ifelse(myDelayT$Month=="July","2015-07-30",
ifelse(myDelayT$Month=="August","2015-08-30",
ifelse(myDelayT$Month=="September","2015-09-30",
ifelse(myDelayT$Month=="October","2015-10-30",
"2015-11-30"))))))))))
myDelayT<-myDelayT[c(2:5)]
myDelayT<- myDelayT[order(myDelayT$date),]
write.csv(myDelayT,"myDelayTN.csv",row.names=FALSE)
AnnualDelay<-aggregate(Delays$Delay, by=list(Delays$Yr), FUN=sum, na.rm=TRUE)
colnames(AnnualDelay)<-c("Year","x")
AnnualDelay$DelaySum<-AnnualDelay$x/60
View(AnnualDelay)
(763.3833-578.8333)/578.8333
763.3833/24
myDelayT<-myDelay
myDelayT$date<-ifelse(myDelayT$Month=="January",as.date("2015-01-30"),
ifelse(myDelayT$Month=="February",as.date("2015-02-28"),
ifelse(myDelayT$Month=="March",as.date("2015-03-30"),
ifelse(myDelayT$Month=="April",as.date("2015-04-30"),
ifelse(myDelayT$Month=="May",as.date("2015-05-30"),
ifelse(myDelayT$Month=="June",as.date("2015-06-30"),
ifelse(myDelayT$Month=="July",as.date("2015-07-30"),
ifelse(myDelayT$Month=="August",as.date("2015-08-30"),
ifelse(myDelayT$Month=="September",as.date("2015-09-30"),
ifelse(myDelayT$Month=="October",as.date("2015-10-30"),
as.date("2015-11-30")))))))))))
myDelayT$date<-ifelse(myDelayT$Month=="January",as.Date("2015-01-30"),
ifelse(myDelayT$Month=="February",as.Date("2015-02-28"),
ifelse(myDelayT$Month=="March",as.Date("2015-03-30"),
ifelse(myDelayT$Month=="April",as.Date("2015-04-30"),
ifelse(myDelayT$Month=="May",as.Date("2015-05-30"),
ifelse(myDelayT$Month=="June",as.Date("2015-06-30"),
ifelse(myDelayT$Month=="July",as.Date("2015-07-30"),
ifelse(myDelayT$Month=="August",as.Date("2015-08-30"),
ifelse(myDelayT$Month=="September",as.Date("2015-09-30"),
ifelse(myDelayT$Month=="October",as.Date("2015-10-30"),
as.Date("2015-11-30")))))))))))
View(myDelayT)
myDelayT<-myDelay
myDelayT$date<-ifelse(myDelayT$Month=="January",as.Date("2015-01-30"),
ifelse(myDelayT$Month=="February",as.Date("2015-02-28"),
ifelse(myDelayT$Month=="March",as.Date("2015-03-30"),
ifelse(myDelayT$Month=="April",as.Date("2015-04-30"),
ifelse(myDelayT$Month=="May",as.Date("2015-05-30"),
ifelse(myDelayT$Month=="June",as.Date("2015-06-30"),
ifelse(myDelayT$Month=="July",as.Date("2015-07-30"),
ifelse(myDelayT$Month=="August",as.Date("2015-08-30"),
ifelse(myDelayT$Month=="September",as.Date("2015-09-30"),
ifelse(myDelayT$Month=="October",as.Date("2015-10-30"),
as.Date("2015-11-30")))))))))))
myDelayT<-myDelayT[c(2:5)]
myDelayT<- myDelayT[order(myDelayT$date),]
write.csv(myDelayT,"myDelayTN.csv",row.names=FALSE)
format(myDelayT$date, format="%Y-%m-%d")
myDelayT$date<-ifelse(myDelayT$Month=="January",as.Date("2015-01-30","%Y-%m-%d"),
ifelse(myDelayT$Month=="February",as.Date("2015-02-28","%Y-%m-%d"),
ifelse(myDelayT$Month=="March",as.Date("2015-03-30","%Y-%m-%d"),
ifelse(myDelayT$Month=="April",as.Date("2015-04-30","%Y-%m-%d"),
ifelse(myDelayT$Month=="May",as.Date("2015-05-30","%Y-%m-%d"),
ifelse(myDelayT$Month=="June",as.Date("2015-06-30","%Y-%m-%d"),
ifelse(myDelayT$Month=="July",as.Date("2015-07-30","%Y-%m-%d"),
ifelse(myDelayT$Month=="August",as.Date("2015-08-30","%Y-%m-%d"),
ifelse(myDelayT$Month=="September",as.Date("2015-09-30","%Y-%m-%d"),
ifelse(myDelayT$Month=="October",as.Date("2015-10-30","%Y-%m-%d"),
as.Date("2015-11-30","%Y-%m-%d")))))))))))
myDelayT<-myDelay
myDelayT$date<-ifelse(myDelayT$Month=="January",as.Date("2015-01-30","%Y-%m-%d"),
ifelse(myDelayT$Month=="February",as.Date("2015-02-28","%Y-%m-%d"),
ifelse(myDelayT$Month=="March",as.Date("2015-03-30","%Y-%m-%d"),
ifelse(myDelayT$Month=="April",as.Date("2015-04-30","%Y-%m-%d"),
ifelse(myDelayT$Month=="May",as.Date("2015-05-30","%Y-%m-%d"),
ifelse(myDelayT$Month=="June",as.Date("2015-06-30","%Y-%m-%d"),
ifelse(myDelayT$Month=="July",as.Date("2015-07-30","%Y-%m-%d"),
ifelse(myDelayT$Month=="August",as.Date("2015-08-30","%Y-%m-%d"),
ifelse(myDelayT$Month=="September",as.Date("2015-09-30","%Y-%m-%d"),
ifelse(myDelayT$Month=="October",as.Date("2015-10-30","%Y-%m-%d"),
as.Date("2015-11-30","%Y-%m-%d")))))))))))
View(myDelayT)
myDelayT<-myDelay
myDelayT$date<-ifelse(myDelayT$Month=="January",as.Date("2015-01-30",format="%Y-%m-%d"),
ifelse(myDelayT$Month=="February",as.Date("2015-02-28",format="%Y-%m-%d"),
ifelse(myDelayT$Month=="March",as.Date("2015-03-30",format="%Y-%m-%d"),
ifelse(myDelayT$Month=="April",as.Date("2015-04-30",format="%Y-%m-%d"),
ifelse(myDelayT$Month=="May",as.Date("2015-05-30",format="%Y-%m-%d"),
ifelse(myDelayT$Month=="June",as.Date("2015-06-30",format="%Y-%m-%d"),
ifelse(myDelayT$Month=="July",as.Date("2015-07-30",format="%Y-%m-%d"),
ifelse(myDelayT$Month=="August",as.Date("2015-08-30",format="%Y-%m-%d"),
ifelse(myDelayT$Month=="September",as.Date("2015-09-30",format="%Y-%m-%d"),
ifelse(myDelayT$Month=="October",as.Date("2015-10-30",format="%Y-%m-%d"),
as.Date("2015-11-30",format="%Y-%m-%d")))))))))))
View(myDelayT)
as.Date("2015-01-31")
as.Date("2015-01-30")
MonthDate<-c(as.Date("2015-01-30",format="%Y-%m-%d"),
as.Date("2015-02-28",format="%Y-%m-%d"),
as.Date("2015-03-30",format="%Y-%m-%d"),
as.Date("2015-04-30",format="%Y-%m-%d"),
as.Date("2015-05-30",format="%Y-%m-%d"),
as.Date("2015-06-30",format="%Y-%m-%d"),
as.Date("2015-07-30",format="%Y-%m-%d"),
as.Date("2015-08-30",format="%Y-%m-%d"),
as.Date("2015-09-30",format="%Y-%m-%d"),
as.Date("2015-10-30",format="%Y-%m-%d"),
as.Date("2015-11-30",format="%Y-%m-%d"))
MonthDate
MonthDate<-as.data.frame(c(as.Date("2015-01-30",format="%Y-%m-%d"),
as.Date("2015-02-28",format="%Y-%m-%d"),
as.Date("2015-03-30",format="%Y-%m-%d"),
as.Date("2015-04-30",format="%Y-%m-%d"),
as.Date("2015-05-30",format="%Y-%m-%d"),
as.Date("2015-06-30",format="%Y-%m-%d"),
as.Date("2015-07-30",format="%Y-%m-%d"),
as.Date("2015-08-30",format="%Y-%m-%d"),
as.Date("2015-09-30",format="%Y-%m-%d"),
as.Date("2015-10-30",format="%Y-%m-%d"),
as.Date("2015-11-30",format="%Y-%m-%d")))
View(MonthDate)
myDelayT<-cbind(myDelay,MonthDate)
View(myDelayT)
myDelayT<-myDelayT[c(2:5)]
colnames(myDelayT)<-c("2013","2014","2015","date")
myDelayT<- myDelayT[order(myDelayT$date),]
View(myDelayT)
str(myDelayT)
write.csv(myDelayT,"myDelayTN.csv",row.names=FALSE)
MonthDate<-as.data.frame(c(as.Date("2015-01-30"),
as.Date("2015-02-28"),
as.Date("2015-03-30"),
as.Date("2015-04-30"),
as.Date("2015-05-30"),
as.Date("2015-06-30"),
as.Date("2015-07-30"),
as.Date("2015-08-30"),
as.Date("2015-09-30"),
as.Date("2015-10-30"),
as.Date("2015-11-30"))
MonthDate<-as.data.frame(c(as.Date("2015-01-30"),
MonthDate<-as.data.frame(c(as.Date("2015-01-30"),
as.Date("2015-02-28"),
as.Date("2015-03-30"),
as.Date("2015-04-30"),
as.Date("2015-05-30"),
as.Date("2015-06-30"),
as.Date("2015-07-30"),
as.Date("2015-08-30"),
as.Date("2015-09-30"),
as.Date("2015-10-30"),
as.Date("2015-11-30")))
View(MonthDate)
myDelayT<-cbind(myDelay,MonthDate)
str(myDelayT)
library(stringr)
library(plyr)
library(reshape)
DelayRaw<-read.csv("/Users/katerabinowitz/Documents/DataLensDC/WMATA-Delay/Wmata-Delay/WMATAService.csv",
stringsAsFactors=FALSE, strip.white=TRUE)
DelayRaw<-subset(DelayRaw,grepl('[a-z]',DelayRaw$Incident) & !(grepl('Report Archives',DelayRaw$Incident)))
DelayRaw$LongDay<-gsub("Daily Service Report for ", "",DelayRaw$Date)
Date<-as.data.frame(strsplit(DelayRaw$LongDay,", "))
Date<-as.data.frame(t(Date))
colnames(Date)<-c("Day","MD","Yr")
Delays<-cbind(DelayRaw,Date)
Delays<-subset(Delays,Delays$Incident!="Wednesday November 18, 2014    ")
Delays$DayType<-ifelse(Delays$Day %in% c("Saturday","Sunday"), "Weekend","Weekday")
Delays$Month<-gsub( " .*$", "", Delays$MD)
Delays$Time<-substr(Delays$Incident,1,10)
Delays$Hour<-ifelse(Delays$Time=="\n5 57 p.m.",5,
ifelse(Delays$Time=="\n* 5:00 p.",5,
ifelse(Delays$Time=="\n803 a.m. ",8,
as.numeric(gsub(":.*$","",Delays$Time)))))
Delays<-subset(Delays,!is.na(Delays$Hour) & !(Delays$Month=="December") & !(Delays$Yr=="2012"))
str(Delays)
View(Delays)
Delays$DayN<-as.numeric(str_extract(Delays$MD,"[[:digit:]]+"))
View(Delays)
Delays$DayN<-as.numeric(str_extract(Delays$MD,"[[:digit:]]+"))
Delays$Time<-substr(Delays$Incident,1,10)
Delays$Hour<-ifelse(Delays$Time=="\n5 57 p.m.",5,
ifelse(Delays$Time=="\n* 5:00 p.",5,
ifelse(Delays$Time=="\n803 a.m. ",8,
as.numeric(gsub(":.*$","",Delays$Time)))))
Delays<-subset(Delays,!is.na(Delays$Hour) & !(Delays$Month=="December") & !(Delays$Yr=="2012"))
Delays<-subset(Delays,!(Delays$Month=='November' & Delays$DayN>24))
Delays$Hour24<-ifelse((grepl("p",Delays$Time) & Delays$Hour==12),Delays$Hour,
ifelse(grepl("p",Delays$Time),Delays$Hour+12,Delays$Hour))
Delays$TimeGroup<-ifelse(Delays$DayType=="Weekday" & Delays$Hour24 %in% c(6,7,8,9),"Rush",
ifelse(Delays$DayType=="Weekday" & Delays$Hour24 %in% c(16,17,18,19),"Rush",
"Off Rush"))
View(Delays)
View(Delays)
Delays<-Delays[c(3,5:9,13:14)]
Delays$Suspend<-ifelse(grepl("suspend",Delays$Incident),1,
ifelse(grepl("Suspend",Delays$Incident),1,0))
Delays$Closed<-ifelse(grepl("close",Delays$Incident),1,
ifelse(grepl("Close",Delays$Incident),1,0))
Delays$Offload<-ifelse(grepl("offload",Delays$Incident),1,
ifelse(grepl("Offload",Delays$Incident),1,0))
Delays$Shuttle<-ifelse(grepl("Shuttle",Delays$Incident),1,
ifelse(grepl("shuttle",Delays$Incident),1,0))
Delays$SingleTrack<-ifelse(grepl("ingle",Delays$Incident),1,0)
Delays$Express<-ifelse(grepl("xpress",Delays$Incident),1,0)
Delays$Reroute<-ifelse(grepl("eroute",Delays$Incident),1,
ifelse(grepl("changed to", Delays$Incident),1,0))
Delays$Issue<-ifelse(grepl("perational problem",Delays$Incident),"Operational",
ifelse((grepl("maintenance",Delays$Incident) | grepl("unscheduled track work",Delays$Incident) | grepl("late",Delays$Incident) |
grepl("disabled work unit",Delays$Incident)),"Maintenance",
ifelse((grepl("signal problem",Delays$Incident) | grepl("door problem",Delays$Incident) | grepl("equipment problem",Delays$Incident) |
grepl("brake problem",Delays$Incident) | grepl("break problem",Delays$Incident)| grepl("track problem",Delays$Incident) |
grepl("power problem",Delays$Incident) | grepl("switch problem",Delays$Incident) | grepl("mechanical problem",Delays$Incident) |
grepl("escalator",Delays$Incident) | grepl("elevator",Delays$Incident) | grepl("cracked rail",Delays$Incident) |
grepl("cracked third",Delays$Incident)),"Mechnical",
ifelse((grepl("disabled No",Delays$Incident) | grepl("disabled no",Delays$Incident) | grepl("derail",Delays$Incident)),"Trains",
ifelse((grepl("fire",Delays$Incident) | grepl("smoke",Delays$Incident) | grepl("police",Delays$Incident) |
grepl("emergency",Delays$Incident) | grepl("MTPD",Delays$Incident) | grepl("burning",Delays$Incident) |
grepl("smolder",Delays$Incident) | grepl("unattended package",Delays$Incident) |
grepl("suspicious package",Delays$Incident)),"FireCrime",
ifelse((grepl("medical",Delays$Incident) | grepl("sick",Delays$Incident) | grepl("unauthorized person",Delays$Incident) |
grepl("passenger interfering",Delays$Incident) | grepl("deer",Delays$Incident) | grepl("weather",Delays$Incident)|
grepl("Presidential",Delays$Incident)| grepl("slippery",Delays$Incident) | grepl("person struck",Delays$Incident) |
grepl("passenger struck",Delays$Incident) | grepl("obstruction",Delays$Incident) | grepl("customer",Delays$Incident) |
grepl("assist a passenger",Delays$Incident) | grepl("assisting a passenger",Delays$Incident) |
grepl("passenger falling",Delays$Incident) | grepl("child",Delays$Incident) | grepl("bird",Delays$Incident) |
grepl("dog",Delays$Incident)),"External",
ifelse(grepl("did not operate",Delays$Incident) | grepl("schedule",Delays$Incident),"Schedule",
"NA")))))))
###Delay Time###
Delays$ShortInc<-substr(Delays$Incident,11,1000)
Delays$ShortInc<-gsub('minute.*','',Delays$ShortInc)
Delays$ShortInc<-gsub(".*\\.m.","",Delays$ShortInc)
Delays$Delay<-as.numeric(str_extract(Delays$ShortInc,"[[:digit:]]+"))
Delays$Delay<-ifelse((is.na(Delays$Delay)& Delays$Offload==1),8,
ifelse((is.na(Delays$Delay)& Delays$Suspend==1),40,
ifelse((is.na(Delays$Delay)& Delays$Shuttle==1),40,
ifelse((is.na(Delays$Delay)& Delays$SingleTrack==1),20,
ifelse((is.na(Delays$Delay)& grepl("ignificant delay",Delays$Incident)),40,
ifelse((is.na(Delays$Delay)& grepl("delay",Delays$Incident)),8,
Delays$Delay))))))
Delays$Silver<-ifelse(grepl("Silver",Delays$Incident),1,0)
Delays$Orange<-ifelse(grepl("Orange",Delays$Incident),1,0)
Delays$Blue<-ifelse(grepl("Blue",Delays$Incident),1,0)
Delays$Red<-ifelse(grepl("Red",Delays$Incident),1,0)
Delays$Yellow<-ifelse(grepl("Yellow",Delays$Incident),1,0)
Delays$Green<-ifelse(grepl("Green",Delays$Incident),1,0)
Delays$Bound<-ifelse(grepl("Largo Town Center-bound",Delays$Incident),"Largo",
ifelse(grepl("Largo-bound",Delays$Incident),"Largo",
ifelse(grepl("New Carrollton-bound",Delays$Incident),"New Carrollton",
ifelse(grepl("New Carrolton-bound",Delays$Incident),"New Carrollton",
ifelse(grepl("Greenbelt-bound",Delays$Incident),"Greenbelt",
ifelse(grepl("Glenmont-bound",Delays$Incident),"Glenmont",
ifelse(grepl("Shady Grove-bound",Delays$Incident),"Shady Grove",
ifelse(grepl("Shady Grove- bound",Delays$Incident),"Shady Grove",
ifelse(grepl("Wiehle-Reston East-bound",Delays$Incident),"Wiehle-Reston East",
ifelse(grepl("Vienna-bound",Delays$Incident),"Vienna",
ifelse(grepl("Franconia-Springfield-bound",Delays$Incident),"Franconia-Springfield",
ifelse(grepl("Branch Avenue-bound",Delays$Incident),"Branch Avenue",
ifelse(grepl("Branch Ave-bound",Delays$Incident),"Branch Avenue",
ifelse(grepl("Huntington-bound",Delays$Incident),"Huntington",
ifelse(grepl("Grosvenor-Strathmore-bound",Delays$Incident),"Grosvenor-Strathmore",
ifelse(grepl("Grosvenor-bound",Delays$Incident),"Grosvenor-Strathmore",
ifelse(grepl("Mt. Vernon Square-bound",Delays$Incident),"Mt. Vernon Square",
ifelse(grepl("Mt. Vernon-bound",Delays$Incident),"Mt. Vernon Square",
ifelse(grepl("Mt. Vernon Sq-bound",Delays$Incident),"Mt. Vernon Square",
ifelse(grepl("Silver Spring-bound",Delays$Incident),"Silver Spring",
ifelse(grepl("Fort Totten-bound",Delays$Incident),"Fort Totten",
ifelse(grepl("Ft Totten-bound",Delays$Incident),"Fort Totten",
ifelse(grepl("Ft. Totten-bound",Delays$Incident),"Fort Totten",
ifelse(grepl("NoMa-Gallaudet-bound",Delays$Incident),"NoMa-Gallaudet",
ifelse(grepl("Medical Center-bound",Delays$Incident),"Medical Center",
ifelse(grepl("Friendship Heights-bound",Delays$Incident),"Friendship Height",
ifelse(grepl("Van Dorn Street-bound",Delays$Incident),"Van Dorn Street",
ifelse(grepl("Judiciary Square-bound",Delays$Incident),"Judiciary Square",
ifelse(grepl("Grosvenor -bound",Delays$Incident),"Grosvenor-Strathmore",
ifelse(grepl("Branch Ave -bound",Delays$Incident),"Branch Avenue",
ifelse(grepl("Greenbelt Ave-bound",Delays$Incident),"Greenbelt Avenue",
ifelse(grepl("Van Ness-bound",Delays$Incident),"Van Ness",
"N/A"))))))))))))))))))))))))))))))))
aggregate(Delays$Delay, by=list(Delays$TimeGroup), FUN=mean, na.rm=TRUE)
count(Delays$Delay, c('Delays$TimeGroup'))
aggregate(Delays$Delay, by=list(Delays$DayType), FUN=mean, na.rm=TRUE)
count(Delays$Delay, c('Delays$DayType'))
count(Delays$Delay, c('Delays$Day'))
myDelayN<-count(Delays$Delay, c('Delays$Month','Delays$Yr'))
myDelay<-cast(myDelayN,Delays.Month~Delays.Yr)
colnames(myDelay)<-c("Month","Yr2013","Yr2014","Yr2015")
View(myDelay)
MonthDate<-as.data.frame(c(as.Date("2015-04-01"),
as.Date("2015-08-01"),
as.Date("2015-02-01"),
as.Date("2015-01-01"),
as.Date("2015-07-01"),
as.Date("2015-06-01"),
as.Date("2015-03-01"),
as.Date("2015-05-01"),
as.Date("2015-11-01"),
as.Date("2015-10-01"),
as.Date("2015-9-01")))
myDelayT<-cbind(myDelay,MonthDate)
View(myDelayT)
myDelayT<-myDelayT[c(2:5)]
colnames(myDelayT)<-c("2013","2014","2015","date")
myDelayT<- myDelayT[order(myDelayT$date),]
write.csv(myDelayT,"myDelayTN.csv",row.names=FALSE)
View(myDelay)
write.csv(myDelay,"myDelayN.csv",row.names=FALSE)
AnnualDelay<-aggregate(Delays$Delay, by=list(Delays$Yr), FUN=sum, na.rm=TRUE)
colnames(AnnualDelay)<-c("Year","x")
AnnualDelay$DelaySum<-AnnualDelay$x/60
View(AnnualDelay)
(763-572)/572
write.csv(AnnualDelay,"AnnualDelay.csv",row.names=FALSE)
DelayIssue<-as.data.frame(table(DelayTime$Issue,DelayTime$Yr))
DelayTime<-subset(Delays,!is.na(Delays$Delay))
count(DelayTime$Delay, c('DelayTime$Yr'))
DelayIssue<-as.data.frame(table(DelayTime$Issue,DelayTime$Yr))
Issue<-cast(DelayIssue,Var1~Var2)[c(1,3:5)]
colnames(Issue)<-c("Issue","Yr2013","Yr2014","Yr2015")
write.csv(Issue,"DelayIssue.csv",row.names=FALSE)
763.3833/24
763/328
View(DelayIssue)
1930/(1930+9+512+3+2495+99+345+75)
aggregate(Delays$Delay, by=list(Delays$Yr), FUN=mean, na.rm=TRUE)
count(Delays$Delay, c('Delays$Yr'))
(6781-3660)/3660
View(myDelayN)
count(Delays$Express, c('Delays$Yr'))
aggregate(Delays$Express, by=list(Delays$Yr), FUN=sum, na.rm=TRUE)
count(DelayTime$Delay, c('DelayTime$Yr'))
(5468-3278)/3278
DNO<-subset(DelayTime$DNO==1)
DelayTime$DNO<-ifelse(grepl("did not operate",DelayTime$Incident),1,0)
DNO<-subset(DelayTime$DNO==1)
DNO<-subset(DelayTime,DelayTime$DNO==1)
View(DNO)
(512-439)/439
(439-278)/278
DelayTime<-subset(Delays,!is.na(Delays$Delay))
count(DelayTime$Delay, c('DelayTime$Yr'))
(5468-4087)
1000/138
1000/1381
